<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoryFrame | Premium Video Photo Frames</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
        // Initialize EmailJS
        (function() {
            emailjs.init("user_lCTQCFyLtJ0XNvlAjyRfC");
        })();
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="#" class="logo">Memory<span>Frame</span></a>
            <div class="nav-menu">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#features" class="nav-link">Features</a>
                <a href="#how-it-works" class="nav-link">How It Works</a>
                <a href="#create" class="nav-link">Create Frame</a>
                <a href="#order" class="nav-link">Order</a>
                <a href="scan.html" class="nav-link scanner-link"><i class="fas fa-qrcode"></i> Scanner</a>
            </div>
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- Hero Slider -->
    <section class="hero" id="home">
        <div class="hero-slider">
            <!-- Slide 1 -->
            <div class="slide active">
                <div class="slide-content">
                    <h1 class="glitch-text" data-text="Memories Come Alive">Memories Come Alive</h1>
                    <p class="slide-subtitle">Transform your cherished moments into interactive video experiences</p>
                    <a href="#order" class="btn btn-gold">Order Your Frame</a>
                </div>
                <div class="slide-overlay"></div>
            </div>
            
            <!-- Slide 2 -->
            <div class="slide">
                <div class="slide-content">
                    <h1 class="glitch-text" data-text="Scan & Watch">Scan & Watch</h1>
                    <p class="slide-subtitle">Scan the QR code with our app to relive your memories in motion</p>
                    <a href="scan.html" class="btn btn-gold">Try Scanner</a>
                </div>
                <div class="slide-overlay"></div>
            </div>
            
            <!-- Slide 3 -->
            <div class="slide">
                <div class="slide-content">
                    <h1 class="glitch-text" data-text="Premium Quality">Premium Quality</h1>
                    <p class="slide-subtitle">Handcrafted frames with museum-grade materials and technology</p>
                    <a href="#order" class="btn btn-gold">Order Now</a>
                </div>
                <div class="slide-overlay"></div>
            </div>
            
            <!-- Slider Controls -->
            <button class="slider-btn prev-btn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-btn next-btn">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <!-- Slider Dots -->
            <div class="slider-dots">
                <span class="dot active"></span>
                <span class="dot"></span>
                <span class="dot"></span>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="features">
        <div class="container">
            <h2 class="section-title">Premium <span>Features</span></h2>
            <p class="section-subtitle">Experience the future of memory preservation with our cutting-edge technology</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <h3>Premium Frames</h3>
                    <p>Handcrafted from premium materials with scratch-resistant glass and solid wood finishes.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-vr-cardboard"></i>
                    </div>
                    <h3>AR Experience</h3>
                    <p>Augmented Reality integration brings your photos to life with immersive 3D effects.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <h3>Video Integration</h3>
                    <p>Embed up to 10 minutes of video per frame, accessible instantly via QR code scanning.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>Cloud Storage</h3>
                    <p>Secure cloud storage ensures your memories are backed up and accessible forever.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works" id="how-it-works">
        <div class="container">
            <h2 class="section-title">How It <span>Works</span></h2>
            <p class="section-subtitle">Create your interactive memory frame in just three simple steps</p>
            
            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Create & Upload</h3>
                        <p>Sign up for an account, then upload your photo and video content through our secure portal.</p>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Customize Frame</h3>
                        <p>Choose your frame style, add titles and descriptions, and generate your unique QR code.</p>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Receive & Enjoy</h3>
                        <p>We'll ship your custom frame to your door. Scan with our app to watch memories come alive.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Create Frame Section -->
    <section class="create-frame" id="create">
        <div class="container">
            <h2 class="section-title">Create Your <span>MemoryFrame</span></h2>
            <p class="section-subtitle">Sign in to start creating your interactive photo frame</p>
            
            <!-- Authentication Form -->
            <div class="auth-container" id="authContainer">
                <div class="auth-form active" id="signinForm">
                    <h3>Sign In</h3>
                    <div class="form-group">
                        <input type="email" id="signinEmail" placeholder="Email Address" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="signinPassword" placeholder="Password" required>
                    </div>
                    <button class="btn btn-gold" id="signinBtn">Sign In</button>
                    <p class="auth-switch">Don't have an account? <a href="#" id="switchToSignup">Sign Up</a></p>
                </div>
                
                <div class="auth-form" id="signupForm">
                    <h3>Sign Up</h3>
                    <div class="form-group">
                        <input type="email" id="signupEmail" placeholder="Email Address" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="signupPassword" placeholder="Password (min. 6 characters)" required>
                    </div>
                    <button class="btn btn-gold" id="signupBtn">Create Account</button>
                    <p class="auth-switch">Already have an account? <a href="#" id="switchToSignin">Sign In</a></p>
                </div>
                
                <div class="auth-status" id="authStatus"></div>
            </div>
            
            <!-- Frame Creation Interface (Hidden until auth) -->
            <div class="create-interface" id="createInterface" style="display: none;">
                <div class="create-form">
                    <h3>Create New MemoryFrame</h3>
                    
                    <div class="form-group">
                        <label for="frameTitle">Frame Title</label>
                        <input type="text" id="frameTitle" placeholder="e.g., Our Wedding Day" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="frameDescription">Description</label>
                        <textarea id="frameDescription" placeholder="Describe your memory..." rows="3"></textarea>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-box">
                            <i class="fas fa-image"></i>
                            <h4>Upload Photo</h4>
                            <p>JPG or PNG, max 5MB</p>
                            <input type="file" id="photoUpload" accept="image/*">
                            <div class="preview-container" id="photoPreview"></div>
                        </div>
                        
                        <div class="upload-box">
                            <i class="fas fa-video"></i>
                            <h4>Upload Video</h4>
                            <p>MP4 or MOV, max 50MB</p>
                            <input type="file" id="videoUpload" accept="video/*">
                            <div class="preview-container" id="videoPreview"></div>
                        </div>
                    </div>
                    
                    <button class="btn btn-gold" id="createFrameBtn">Create MemoryFrame</button>
                    <div class="create-status" id="createStatus"></div>
                </div>
                
                <!-- User's Created Frames -->
                <div class="user-frames">
                    <h3>Your MemoryFrames</h3>
                    <div class="frames-grid" id="framesGrid">
                        <!-- Frames will be loaded here dynamically -->
                        <div class="empty-frames">
                            <i class="fas fa-images"></i>
                            <p>No frames created yet. Create your first MemoryFrame!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Order Form Section -->
    <section class="order-section" id="order">
        <div class="container">
            <h2 class="section-title">Order Your <span>MemoryFrame</span></h2>
            <p class="section-subtitle">Premium quality frame with embedded QR technology</p>
            
            <div class="order-container">
                <div class="order-info">
                    <div class="package-card">
                        <div class="package-header">
                            <h3>Premium MemoryFrame</h3>
                            <div class="price">$49.99</div>
                        </div>
                        <div class="package-features">
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>10" x 8" Premium Wood Frame</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Scratch-Resistant Glass</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Embedded QR Code Technology</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>5-Year Cloud Storage</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Free Mobile App Access</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Worldwide Shipping Included</span>
                            </div>
                        </div>
                        <div class="package-footer">
                            <div class="discount">Limited Time Offer</div>
                        </div>
                    </div>
                </div>
                
                <div class="order-form">
                    <h3>Place Your Order</h3>
                    <form id="orderForm">
                        <div class="form-group">
                            <input type="text" id="orderName" placeholder="Full Name" required>
                        </div>
                        
                        <div class="form-group">
                            <input type="email" id="orderEmail" placeholder="Email Address" required>
                        </div>
                        
                        <div class="form-group">
                            <input type="tel" id="orderPhone" placeholder="Phone Number" required>
                        </div>
                        
                        <div class="form-group">
                            <textarea id="orderRequirements" placeholder="Special Requirements (frame color, shipping instructions, etc.)" rows="4"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <div class="quantity-selector">
                                <label for="orderQuantity">Quantity:</label>
                                <select id="orderQuantity">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-gold" id="submitOrderBtn">
                            <span>Place Order</span>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                        
                        <div class="order-status" id="orderStatus"></div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <a href="#" class="logo">Memory<span>Frame</span></a>
                    <p>Bringing memories to life through innovative technology.</p>
                </div>
                
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <a href="#home">Home</a>
                    <a href="#features">Features</a>
                    <a href="#how-it-works">How It Works</a>
                    <a href="#create">Create Frame</a>
                    <a href="#order">Order</a>
                    <a href="scan.html">Scanner</a>
                </div>
                
                <div class="footer-contact">
                    <h4>Contact Us</h4>
                    <p><i class="fas fa-envelope"></i> support@memoryframe.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Tech Avenue, San Francisco, CA</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 MemoryFrame. All rights reserved.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://natsnkvqokwbrdoqbzrz.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5hdHNua3Zxb2t3YnJkb3FienJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5NjI3MzYsImV4cCI6MjA1MzUzODczNn0.G-jUJe1UKneLftV9dzDWBQ_Dxf2hrJpGGT2E6L_uHSQ';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        // Global state
        let currentUser = null;
        let authCheckComplete = false;

        // DOM Elements
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.querySelector('.nav-menu');
        const navLinks = document.querySelectorAll('.nav-link');
        const heroSlider = document.querySelector('.hero-slider');
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        const prevBtn = document.querySelector('.prev-btn');
        const nextBtn = document.querySelector('.next-btn');
        const authContainer = document.getElementById('authContainer');
        const createInterface = document.getElementById('createInterface');
        const signinForm = document.getElementById('signinForm');
        const signupForm = document.getElementById('signupForm');
        const switchToSignup = document.getElementById('switchToSignup');
        const switchToSignin = document.getElementById('switchToSignin');
        const signinBtn = document.getElementById('signinBtn');
        const signupBtn = document.getElementById('signupBtn');
        const authStatus = document.getElementById('authStatus');
        const createFrameBtn = document.getElementById('createFrameBtn');
        const createStatus = document.getElementById('createStatus');
        const framesGrid = document.getElementById('framesGrid');
        const orderForm = document.getElementById('orderForm');
        const orderStatus = document.getElementById('orderStatus');
        const submitOrderBtn = document.getElementById('submitOrderBtn');
        const photoUpload = document.getElementById('photoUpload');
        const videoUpload = document.getElementById('videoUpload');
        const photoPreview = document.getElementById('photoPreview');
        const videoPreview = document.getElementById('videoPreview');

        // Mobile Menu Toggle
        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            menuToggle.querySelector('i').classList.toggle('fa-bars');
            menuToggle.querySelector('i').classList.toggle('fa-times');
        });

        // Close mobile menu when clicking a link
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    navMenu.classList.remove('active');
                    menuToggle.querySelector('i').classList.add('fa-bars');
                    menuToggle.querySelector('i').classList.remove('fa-times');
                }
                
                // Update active nav link
                navLinks.forEach(item => item.classList.remove('active'));
                link.classList.add('active');
            });
        });

        // Hero Slider
        let currentSlide = 0;
        const totalSlides = slides.length;
        let slideInterval;

        function showSlide(index) {
            // Ensure index is within bounds
            if (index >= totalSlides) currentSlide = 0;
            else if (index < 0) currentSlide = totalSlides - 1;
            else currentSlide = index;
            
            // Hide all slides
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            // Show current slide
            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
        }

        function nextSlide() {
            showSlide(currentSlide + 1);
        }

        function prevSlide() {
            showSlide(currentSlide - 1);
        }

        function startSlider() {
            slideInterval = setInterval(nextSlide, 5000);
        }

        function stopSlider() {
            clearInterval(slideInterval);
        }

        // Initialize slider
        startSlider();

        // Slider controls
        nextBtn.addEventListener('click', () => {
            stopSlider();
            nextSlide();
            startSlider();
        });

        prevBtn.addEventListener('click', () => {
            stopSlider();
            prevSlide();
            startSlider();
        });

        // Dot controls
        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                stopSlider();
                showSlide(index);
                startSlider();
            });
        });

        // Pause slider on hover
        heroSlider.addEventListener('mouseenter', stopSlider);
        heroSlider.addEventListener('mouseleave', startSlider);

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                if (this.getAttribute('href') === '#') return;
                
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#home') {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const offset = 80;
                        const targetPosition = targetElement.offsetTop - offset;
                        window.scrollTo({ top: targetPosition, behavior: 'smooth' });
                    }
                }
            });
        });

        // Auth form switching
        switchToSignup.addEventListener('click', (e) => {
            e.preventDefault();
            signinForm.classList.remove('active');
            signupForm.classList.add('active');
        });

        switchToSignin.addEventListener('click', (e) => {
            e.preventDefault();
            signupForm.classList.remove('active');
            signinForm.classList.add('active');
        });

        // Sign in function
        signinBtn.addEventListener('click', async () => {
            const email = document.getElementById('signinEmail').value;
            const password = document.getElementById('signinPassword').value;
            
            if (!email || !password) {
                showAuthStatus('Please fill in all fields', 'error');
                return;
            }
            
            try {
                showAuthStatus('Signing in...', 'loading');
                
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) throw error;
                
                currentUser = data.user;
                showAuthStatus('Sign in successful!', 'success');
                setTimeout(() => {
                    updateAuthUI();
                }, 1000);
                
            } catch (error) {
                showAuthStatus(error.message, 'error');
            }
        });

        // Sign up function
        signupBtn.addEventListener('click', async () => {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            
            if (!email || !password) {
                showAuthStatus('Please fill in all fields', 'error');
                return;
            }
            
            if (password.length < 6) {
                showAuthStatus('Password must be at least 6 characters', 'error');
                return;
            }
            
            try {
                showAuthStatus('Creating account...', 'loading');
                
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password
                });
                
                if (error) throw error;
                
                currentUser = data.user;
                showAuthStatus('Account created successfully! Please check your email to confirm your account.', 'success');
                setTimeout(() => {
                    updateAuthUI();
                }, 2000);
                
            } catch (error) {
                showAuthStatus(error.message, 'error');
            }
        });

        // Show auth status message
        function showAuthStatus(message, type) {
            authStatus.textContent = message;
            authStatus.className = 'auth-status';
            authStatus.classList.add(type);
            authStatus.style.display = 'block';
            
            if (type !== 'loading') {
                setTimeout(() => {
                    authStatus.style.display = 'none';
                }, 5000);
            }
        }

        // Update UI based on auth state
        function updateAuthUI() {
            if (currentUser) {
                authContainer.style.display = 'none';
                createInterface.style.display = 'block';
                loadUserFrames();
            } else {
                authContainer.style.display = 'block';
                createInterface.style.display = 'none';
            }
        }

        // Check current auth state
        async function checkAuthState() {
            const { data, error } = await supabase.auth.getUser();
            
            if (!error && data.user) {
                currentUser = data.user;
            }
            
            updateAuthUI();
            authCheckComplete = true;
        }

        // Initialize auth check
        checkAuthState();

        // File upload preview
        photoUpload.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    photoPreview.innerHTML = `<img src="${e.target.result}" alt="Photo Preview">`;
                };
                reader.readAsDataURL(file);
            }
        });

        videoUpload.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    videoPreview.innerHTML = `
                        <video controls>
                            <source src="${e.target.result}" type="${file.type}">
                            Your browser does not support the video tag.
                        </video>
                        <p>${file.name}</p>
                    `;
                };
                reader.readAsDataURL(file);
            }
        });

        // Create MemoryFrame
        createFrameBtn.addEventListener('click', async () => {
            const title = document.getElementById('frameTitle').value;
            const description = document.getElementById('frameDescription').value;
            const photoFile = photoUpload.files[0];
            const videoFile = videoUpload.files[0];
            
            if (!title || !photoFile || !videoFile) {
                showCreateStatus('Please provide a title, photo, and video', 'error');
                return;
            }
            
            if (!currentUser) {
                showCreateStatus('You must be signed in to create frames', 'error');
                return;
            }
            
            try {
                showCreateStatus('Creating your MemoryFrame...', 'loading');
                
                // Upload photo to Supabase Storage
                const photoFileName = `${currentUser.id}/${Date.now()}_photo.${photoFile.name.split('.').pop()}`;
                const { data: photoData, error: photoError } = await supabase.storage
                    .from('frames')
                    .upload(`photos/${photoFileName}`, photoFile);
                
                if (photoError) throw photoError;
                
                // Get photo URL
                const { data: photoUrlData } = supabase.storage
                    .from('frames')
                    .getPublicUrl(`photos/${photoFileName}`);
                
                // Upload video to Supabase Storage
                const videoFileName = `${currentUser.id}/${Date.now()}_video.${videoFile.name.split('.').pop()}`;
                const { data: videoData, error: videoError } = await supabase.storage
                    .from('frames')
                    .upload(`videos/${videoFileName}`, videoFile);
                
                if (videoError) throw videoError;
                
                // Get video URL
                const { data: videoUrlData } = supabase.storage
                    .from('frames')
                    .getPublicUrl(`videos/${videoFileName}`);
                
                // Save frame data to database
                const { data: frameData, error: dbError } = await supabase
                    .from('memory_frames')
                    .insert([
                        {
                            user_id: currentUser.id,
                            title: title,
                            description: description,
                            photo_url: photoUrlData.publicUrl,
                            video_url: videoUrlData.publicUrl,
                            created_at: new Date().toISOString()
                        }
                    ]);
                
                if (dbError) throw dbError;
                
                showCreateStatus('MemoryFrame created successfully!', 'success');
                
                // Clear form
                document.getElementById('frameTitle').value = '';
                document.getElementById('frameDescription').value = '';
                photoUpload.value = '';
                videoUpload.value = '';
                photoPreview.innerHTML = '';
                videoPreview.innerHTML = '';
                
                // Reload user frames
                loadUserFrames();
                
            } catch (error) {
                showCreateStatus(`Error: ${error.message}`, 'error');
            }
        });

        // Show create status message
        function showCreateStatus(message, type) {
            createStatus.textContent = message;
            createStatus.className = 'create-status';
            createStatus.classList.add(type);
            createStatus.style.display = 'block';
            
            if (type !== 'loading') {
                setTimeout(() => {
                    createStatus.style.display = 'none';
                }, 5000);
            }
        }

        // Load user's frames from database
        async function loadUserFrames() {
            if (!currentUser) return;
            
            try {
                const { data, error } = await supabase
                    .from('memory_frames')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                if (data && data.length > 0) {
                    framesGrid.innerHTML = '';
                    
                    data.forEach(frame => {
                        const frameCard = document.createElement('div');
                        frameCard.className = 'frame-card';
                        frameCard.innerHTML = `
                            <div class="frame-card-image">
                                <img src="${frame.photo_url}" alt="${frame.title}">
                                <div class="frame-card-overlay">
                                    <button class="btn-play" data-video="${frame.video_url}">
                                        <i class="fas fa-play"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="frame-card-content">
                                <h4>${frame.title}</h4>
                                <p>${frame.description || 'No description'}</p>
                                <div class="frame-card-date">${new Date(frame.created_at).toLocaleDateString()}</div>
                            </div>
                        `;
                        
                        framesGrid.appendChild(frameCard);
                    });
                    
                    // Add event listeners to play buttons
                    document.querySelectorAll('.btn-play').forEach(button => {
                        button.addEventListener('click', function() {
                            const videoUrl = this.getAttribute('data-video');
                            playVideo(videoUrl);
                        });
                    });
                    
                } else {
                    framesGrid.innerHTML = `
                        <div class="empty-frames">
                            <i class="fas fa-images"></i>
                            <p>No frames created yet. Create your first MemoryFrame!</p>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('Error loading frames:', error);
            }
        }

        // Play video in modal
        function playVideo(videoUrl) {
            const modal = document.createElement('div');
            modal.className = 'video-modal';
            modal.innerHTML = `
                <div class="video-modal-content">
                    <button class="close-modal">&times;</button>
                    <video controls autoplay>
                        <source src="${videoUrl}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal on click
            modal.addEventListener('click', (e) => {
                if (e.target === modal || e.target.classList.contains('close-modal')) {
                    document.body.removeChild(modal);
                }
            });
        }

        // Order form submission with EmailJS
        orderForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('orderName').value;
            const email = document.getElementById('orderEmail').value;
            const phone = document.getElementById('orderPhone').value;
            const requirements = document.getElementById('orderRequirements').value;
            const quantity = document.getElementById('orderQuantity').value;
            
            if (!name || !email || !phone) {
                showOrderStatus('Please fill in all required fields', 'error');
                return;
            }
            
            try {
                submitOrderBtn.disabled = true;
                submitOrderBtn.innerHTML = '<span>Sending Order...</span><i class="fas fa-spinner fa-spin"></i>';
                
                // Prepare template parameters
                const templateParams = {
                    to_name: 'MemoryFrame Team',
                    from_name: name,
                    from_email: email,
                    phone: phone,
                    requirements: requirements || 'No special requirements',
                    quantity: quantity,
                    total_price: (49.99 * quantity).toFixed(2),
                    date: new Date().toLocaleDateString()
                };
                
                // Send email using EmailJS
                const response = await emailjs.send(
                    'service_8dn958k', // Service ID
                    'template_memoryframe', // Template ID (you'll need to create this in EmailJS)
                    templateParams
                );
                
                showOrderStatus('Order placed successfully! We\'ll contact you shortly.', 'success');
                orderForm.reset();
                
            } catch (error) {
                console.error('EmailJS Error:', error);
                showOrderStatus('Failed to send order. Please try again or contact us directly.', 'error');
            } finally {
                submitOrderBtn.disabled = false;
                submitOrderBtn.innerHTML = '<span>Place Order</span><i class="fas fa-paper-plane"></i>';
            }
        });

        // Show order status message
        function showOrderStatus(message, type) {
            orderStatus.textContent = message;
            orderStatus.className = 'order-status';
            orderStatus.classList.add(type);
            orderStatus.style.display = 'block';
            
            setTimeout(() => {
                orderStatus.style.display = 'none';
            }, 5000);
        }

        // Add scroll animation to elements
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, observerOptions);

        // Observe elements for scroll animation
        document.querySelectorAll('.feature-card, .step, .auth-form, .create-form, .package-card, .order-form').forEach(el => {
            observer.observe(el);
        });

        // Initialize EmailJS with service ID
        emailjs.init("user_lCTQCFyLtJ0XNvlAjyRfC");

        // Log to console for debugging
        console.log('MemoryFrame website initialized');
        console.log('Supabase connected:', supabaseUrl);
        console.log('EmailJS initialized with service:', 'service_8dn958k');
    </script>
</body>
</html>